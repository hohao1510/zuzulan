<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop ZuzuLan - Th·ªùi trang m·ªçi l·ª©a tu·ªïi</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

    <!-- C·∫•u h√¨nh Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5dade2',
                        primaryDark: '#2e86c1',
                        secondary: '#34495e',
                        bgLight: '#fcfdfe',
                        accent: '#ff6b6b',
                    },
                    fontFamily: {
                        sans: ['Nunito', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Nunito', sans-serif; background-color: #fcfdfe; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin: 0 auto; height: 300px; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .thumb-selected { 
            border-color: #5dade2 !important; 
            transform: scale(1.1); 
            opacity: 1;
        }
        .thumb-item {
            opacity: 0.7;
            transition: all 0.2s;
        }
        .thumb-item:hover {
            opacity: 1;
        }
        
        #toast { transition: all 0.3s ease-in-out; }

        /* CSS CHO BANNER BACKGROUND */
        .hero-bg {
            /* ƒê∆∞·ªùng d·∫´n ·∫£nh logo l√†m n·ªÅn */
            background-image: url('logo.jpg'); 
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            /* ƒê·∫£m b·∫£o ch·ªØ n·ªïi b·∫≠t tr√™n n·ªÅn ·∫£nh */
            color: white !important; 
        }
        
        /* L·ªõp ph·ªß m·ªù ƒë·ªÉ l√†m n·ªïi ch·ªØ */
        .hero-overlay {
            position: absolute;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.6); /* M√†u ƒëen m·ªù 60% */
            border-radius: 1.5rem; /* Bo g√≥c gi·ªëng container cha */
        }
        
        /* N·ªôi dung banner ph·∫£i n·∫±m tr√™n l·ªõp ph·ªß */
        .hero-content {
            position: relative;
            z-index: 10;
        }
    </style>
</head>
<body class="text-gray-700 flex flex-col min-h-screen relative">

    <!-- TOP BAR -->
    <div class="bg-primary text-white py-2 font-bold text-lg overflow-hidden">
        <marquee direction="left" scrollamount="12">
            Shop qu·∫ßn √°o Zuzulan ch√†o qu√Ω kh√°ch, ch√∫c qu√Ω kh√°ch mua s·∫Øm vui v·∫ª
        </marquee>
    </div>

    <!-- HEADER -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 grid grid-cols-3 items-center">
            
            <!-- Tr√°i: Menu 3 g·∫°ch -->
            <div class="justify-self-start">
                <button class="text-3xl text-primary focus:outline-none hover:text-primaryDark transition" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')">
                    ‚ò∞
                </button>
            </div>

            <!-- Gi·ªØa: Logo ZuzuLan -->
            <div class="justify-self-center flex items-center gap-2 cursor-pointer group" onclick="app.navigate('home')">
                <div class="w-12 h-12 rounded-full overflow-hidden border-2 border-primary group-hover:border-primaryDark transition">
                    <img src="logo.jpg" alt="ZuzuLan" class="w-full h-full object-cover" onerror="this.src='https://via.placeholder.com/60/5dade2/ffffff?text=Z'">
                </div>
                <div class="text-2xl font-bold text-primary font-serif uppercase tracking-wider hidden sm:block group-hover:text-primaryDark transition">
                    ZuzuLan
                </div>
            </div>

            <!-- Ph·∫£i: Gi·ªè h√†ng -->
            <div class="justify-self-end">
                <div class="relative cursor-pointer group" onclick="app.navigate('cart')">
                    <span class="text-3xl text-gray-700 group-hover:text-primary transition">üõí</span>
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-accent text-white text-xs w-5 h-5 flex items-center justify-center rounded-full font-bold shadow-sm">0</span>
                </div>
            </div>
        </div>

        <!-- Menu Mobile -->
        <div id="mobile-menu" class="hidden bg-white border-t border-gray-100 p-4 shadow-lg absolute w-full z-40">
            <div class="flex flex-col gap-3">
                <button onclick="app.filterByCategory('kids')" class="text-left font-bold text-secondary py-2 border-b border-gray-50 hover:text-primary transition">Tr·∫ª em</button>
                <button onclick="app.filterByCategory('adult')" class="text-left font-bold text-secondary py-2 border-b border-gray-50 hover:text-primary transition">N·ªØ</button>
                <button onclick="app.filterByCategory('men')" class="text-left font-bold text-secondary py-2 border-b border-gray-50 hover:text-primary transition">Nam</button>
                <button onclick="app.filterByCategory('winter')" class="text-left font-bold text-secondary py-2 border-b border-gray-50 hover:text-primary transition">ƒê·ªì m√πa ƒë√¥ng</button>
                <button onclick="app.filterByCategory('new')" class="text-left font-bold text-secondary py-2 hover:text-primary transition">H√†ng m·ªõi v·ªÅ</button>
                <button onclick="app.navigate('cart')" class="text-left font-bold text-accent py-2 border-t border-gray-50 mt-2">Xem Gi·ªè H√†ng</button>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <main id="app-container" class="flex-grow container mx-auto px-4 py-8">
        <!-- JS s·∫Ω ƒëi·ªÅn n·ªôi dung v√†o ƒë√¢y -->
    </main>

    <!-- FOOTER -->
    <footer class="bg-gray-800 text-white py-10 mt-auto">
        <div class="container mx-auto px-4 grid grid-cols-1 md:grid-cols-3 gap-8">
            <div>
                <h3 class="text-xl font-bold mb-4 border-b-2 border-primary inline-block pb-1">V·ªÅ ZuzuLan</h3>
                <p class="text-gray-300 text-sm leading-relaxed">N∆°i h·ªôi t·ª• nh·ªØng phong c√°ch th·ªùi trang m·ªõi nh·∫•t d√†nh cho b√© v√† gia ƒë√¨nh.</p>
            </div>
            <div>
                <h3 class="text-xl font-bold mb-4 border-b-2 border-primary inline-block pb-1">Li√™n H·ªá</h3>
                <p class="text-gray-300 text-sm">üìç X√≥m 1, C·ªëng Lao, Nam Thanh, Nam ƒê√†n, NA</p>
                <p class="text-gray-300 text-sm">üìû 096 3456 108</p>
            </div>
            <div>
                <h3 class="text-xl font-bold mb-4 border-b-2 border-primary inline-block pb-1">Th·ªëng K√™</h3>
                <p class="text-gray-300 text-sm">ƒêang ph·ª•c v·ª• h√†ng ng√†n kh√°ch h√†ng.</p>
            </div>
        </div>
        <div class="text-center text-gray-500 text-xs mt-10 pt-4 border-t border-gray-700">¬© 2025 Shop ZuzuLan.</div>
    </footer>

    <!-- MODAL POPUP -->
    <div id="product-modal" class="fixed inset-0 z-[100] hidden bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 transition-opacity duration-300 opacity-0">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col md:flex-row relative transform transition-transform duration-300 scale-95">
            <button onclick="app.closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-800 text-3xl font-bold z-10">&times;</button>
            <div class="w-full md:w-1/2 bg-gray-100 flex flex-col p-4">
                <div class="flex-grow flex items-center justify-center mb-4 h-64 md:h-80 bg-white rounded-lg shadow-inner p-2">
                    <img id="modal-img" src="" class="max-h-full max-w-full object-contain transition-all duration-300">
                </div>
                <div class="flex gap-3 justify-center overflow-x-auto py-2 px-2" id="modal-thumbnails"></div>
            </div>
            <div class="w-full md:w-1/2 p-8 flex flex-col overflow-y-auto no-scrollbar">
                <h2 id="modal-title" class="text-3xl font-bold text-secondary font-serif mb-2"></h2>
                <div class="text-primary font-bold text-2xl mb-4" id="modal-price"></div>
                <div class="mb-6"><h4 class="font-bold text-gray-800 mb-2">M√¥ t·∫£:</h4><p id="modal-desc" class="text-gray-600 italic"></p></div>
                <div class="mt-auto"><button id="modal-add-btn" class="w-full bg-primary hover:bg-primaryDark text-white font-bold py-3 rounded-full shadow-lg transition transform hover:-translate-y-1">Th√™m v√†o gi·ªè h√†ng ngay</button></div>
            </div>
        </div>
    </div>

    <!-- TOAST NOTIFICATION -->
    <div id="toast" class="fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-6 py-3 rounded-full shadow-2xl opacity-0 pointer-events-none z-[200] flex items-center gap-3 border-2 border-white">
        <span class="text-xl bg-white rounded-full w-6 h-6 flex items-center justify-center text-green-600 text-xs">‚úì</span>
        <span id="toast-message" class="font-bold">ƒê√£ th√™m v√†o gi·ªè h√†ng</span>
    </div>

    <!-- SCRIPT -->
    <script>
        const storeData = {
            products: [
                { id: 1, name: "√Åo Len S·ªçc (1831#)", price: 150000, category: "kids", isNew: true, img: "product2.jpg", images: ["product2.jpg", "https://via.placeholder.com/400x400/eee/333?text=Anh+Sau", "https://via.placeholder.com/400x400/eee/333?text=Chi+Tiet"], desc: "√Åo len s·ªçc phong c√°ch H√†n Qu·ªëc, ch·∫•t len m·ªÅm m·ªãn." },
                { id: 2, name: "Qu·∫ßn Caro ·ªêng R·ªông", price: 180000, category: "adult", isNew: true, img: "product3.jpg", images: ["product3.jpg", "https://via.placeholder.com/400x400/eee/333?text=Mau+Khac"], desc: "Qu·∫ßn caro ·ªëng r·ªông th·ªùi th∆∞·ª£ng, v·∫£i th√¥ ƒë≈©i tho√°ng m√°t." },
                { id: 3, name: "√Åo Kho√°c Phao M√πa ƒê√¥ng", price: 350000, category: "winter", isNew: true, img: "product4.jpg", images: ["product4.jpg", "https://via.placeholder.com/400x400/eee/333?text=Ben+Trong"], desc: "√Åo phao 3 l·ªõp si√™u nh·∫π, ch·ªëng th·∫•m n∆∞·ªõc, ·∫•m √°p." },
                { id: 4, name: "V√°y C√¥ng Ch√∫a Elsa", price: 220000, category: "kids", isNew: true, img: "product5.jpg", images: ["product5.jpg", "https://via.placeholder.com/400x400/ffe6ea/ff3366?text=V√°y+Elsa", "https://via.placeholder.com/400x400/ffe6ea/ff3366?text=Mat+Sau"], desc: "V√°y ƒë·∫ßm c√¥ng ch√∫a l·ªông l·∫´y cho b√© ƒëi d·ª± ti·ªác." },
                { id: 5, name: "B·ªô ƒê·ªì Thun L·∫°nh B√© Trai", price: 110000, category: "kids", isNew: false, img: "https://via.placeholder.com/400x400/e0f7fa/00bcd4?text=Do+Be+Trai", images: ["https://via.placeholder.com/400x400/e0f7fa/00bcd4?text=Do+Be+Trai", "https://via.placeholder.com/400x400/e0f7fa/00bcd4?text=Hinh+In"], desc: "B·ªô thun l·∫°nh in h√¨nh si√™u nh√¢n, th·∫•m h√∫t m·ªì h√¥i." },
                { id: 6, name: "√Åo S∆° Mi Nam C√¥ng S·ªü", price: 250000, category: "men", isNew: false, img: "https://via.placeholder.com/400x400/e3f2fd/1e88e5?text=So+Mi+Nam", images: ["https://via.placeholder.com/400x400/e3f2fd/1e88e5?text=So+Mi+Nam"], desc: "S∆° mi nam v·∫£i l·ª•a tre ch·ªëng nhƒÉn, form slimfit." },
                { id: 7, name: "√Åo Hoodie Teen", price: 195000, category: "adult", isNew: false, img: "https://via.placeholder.com/400x400/f3e5f5/8e24aa?text=Hoodie", images: ["https://via.placeholder.com/400x400/f3e5f5/8e24aa?text=Hoodie"], desc: "√Åo Hoodie form r·ªông Unisex, n·ªâ b√¥ng d√†y d·∫∑n." },
                { id: 8, name: "Set D·∫° Tweed M·∫π & B√©", price: 450000, category: "adult", isNew: false, img: "https://via.placeholder.com/400x400/fff3e0/ff9800?text=Set+M·∫π+B√©", images: ["https://via.placeholder.com/400x400/fff3e0/ff9800?text=Set+M·∫π+B√©"], desc: "Set d·∫° Tweed sang ch·∫£nh di·ªán t·∫øt." },
                { id: 9, name: "Qu·∫ßn Jean Nam R√°ch G·ªëi", price: 320000, category: "men", isNew: true, img: "https://via.placeholder.com/400x400/333/fff?text=Jean+Nam", images: ["https://via.placeholder.com/400x400/333/fff?text=Jean+Nam"], desc: "Qu·∫ßn Jean nam phong c√°ch b·ª•i b·∫∑m, ch·∫•t b√≤ co gi√£n." }
            ],
            cart: JSON.parse(localStorage.getItem("zuzulan_cart")) || []
        };

        const app = {
            container: document.getElementById('app-container'),
            currentFilter: 'all',
            
            init() {
                this.updateCartCount();
                this.navigate('home');
            },

            showToast(message, isError = false) {
                const toast = document.getElementById('toast');
                const toastMsg = document.getElementById('toast-message');
                if(isError) {
                    toast.classList.remove('bg-green-600'); toast.classList.add('bg-red-600');
                    toast.querySelector('span').innerText = '!';
                    toast.querySelector('span').classList.add('text-red-600');
                    toast.querySelector('span').classList.remove('text-green-600');
                } else {
                    toast.classList.add('bg-green-600'); toast.classList.remove('bg-red-600');
                    toast.querySelector('span').innerText = '‚úì';
                    toast.querySelector('span').classList.add('text-green-600');
                    toast.querySelector('span').classList.remove('text-red-600');
                }
                toastMsg.innerText = message;
                toast.classList.remove('opacity-0', 'translate-y-10'); toast.classList.add('opacity-100', 'translate-y-0');
                setTimeout(() => { toast.classList.remove('opacity-100', 'translate-y-0'); toast.classList.add('opacity-0', 'translate-y-10'); }, 1500);
            },

            navigate(view) {
                this.container.innerHTML = '';
                document.getElementById('mobile-menu').classList.add('hidden');
                switch(view) {
                    case 'home': this.renderDashboard(); break;
                    case 'shop': 
                        this.currentFilter = 'all';
                        this.renderShop(); 
                        break;
                    case 'cart': this.renderCart(); break;
                    case 'checkout': this.renderCheckout(); break;
                }
                window.scrollTo(0, 0);
            },

            filterByCategory(category) {
                this.currentFilter = category;
                this.renderShop();
                window.scrollTo(0, 0);
                document.getElementById('mobile-menu').classList.add('hidden');
            },

            renderNavBar(activeTab) {
                return `
                    <div class="flex justify-center gap-2 sm:gap-8 mb-8 border-b pb-4 overflow-x-auto">
                        <button onclick="app.filterByCategory('kids')" class="px-6 py-2 rounded-full font-bold transition whitespace-nowrap border-2 ${this.currentFilter === 'kids' && activeTab === 'shop' ? 'bg-primary text-white border-primary shadow-md' : 'border-transparent text-secondary hover:bg-gray-100'}">Tr·∫ª em</button>
                        <button onclick="app.filterByCategory('adult')" class="px-6 py-2 rounded-full font-bold transition whitespace-nowrap border-2 ${this.currentFilter === 'adult' && activeTab === 'shop' ? 'bg-primary text-white border-primary shadow-md' : 'border-transparent text-secondary hover:bg-gray-100'}">N·ªØ</button>
                        <button onclick="app.filterByCategory('men')" class="px-6 py-2 rounded-full font-bold transition whitespace-nowrap border-2 ${this.currentFilter === 'men' && activeTab === 'shop' ? 'bg-primary text-white border-primary shadow-md' : 'border-transparent text-secondary hover:bg-gray-100'}">Nam</button>
                        <button onclick="app.filterByCategory('winter')" class="px-6 py-2 rounded-full font-bold transition whitespace-nowrap border-2 ${this.currentFilter === 'winter' && activeTab === 'shop' ? 'bg-primary text-white border-primary shadow-md' : 'border-transparent text-secondary hover:bg-gray-100'}">ƒê·ªì m√πa ƒë√¥ng</button>
                    </div>
                `;
            },

            renderDashboard() {
                const catCounts = { kids: 0, adult: 0, men: 0, winter: 0 };
                storeData.products.forEach(p => { if(catCounts[p.category] !== undefined) catCounts[p.category]++; });

                this.container.innerHTML = `
                    <div class="space-y-12 animate-fade-in">
                        
                        <!-- BANNER (ƒê√É S·ª¨A L·∫†I ƒê·ªÇ D√ôNG LOGO L√ÄM N·ªÄN) -->
                        <div class="hero-bg text-center py-20 rounded-3xl shadow-md px-6">
                            <div class="hero-overlay"></div> <!-- L·ªõp ph·ªß m·ªù -->
                            <div class="hero-content">
                                <h1 class="text-4xl md:text-6xl font-bold mb-4 font-serif italic drop-shadow-lg">Shop ZuzuLan</h1>
                                <p class="text-xl md:text-2xl mb-8 italic drop-shadow-md">"Phong c√°ch c·ªßa b·∫°n, ni·ªÅm vui c·ªßa ch√∫ng t√¥i."</p>
                                <button onclick="app.filterByCategory('new')" class="bg-primary hover:bg-primaryDark text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition hover:scale-105 mb-8 border-2 border-white/20">H√†ng m·ªõi v·ªÅ</button>
                            </div>
                        </div>

                        <!-- MENU DANH M·ª§C -->
                        <div class="mt-8">
                            ${this.renderNavBar('')}
                        </div>

                        <!-- N·ªòI DUNG CH√çNH -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100">
                                <h3 class="text-xl font-bold text-secondary mb-4">Ph√¢n B·ªë Danh M·ª•c</h3>
                                <div class="chart-container"><canvas id="categoryChart"></canvas></div>
                            </div>
                            <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100 flex flex-col justify-center">
                                <h3 class="text-xl font-bold text-secondary mb-4">Th·ªëng K√™ Nhanh</h3>
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="bg-blue-50 p-4 rounded-lg text-center"><div class="text-3xl font-bold text-primary">${storeData.products.length}</div><div class="text-sm text-gray-600">S·∫£n Ph·∫©m</div></div>
                                    <div class="bg-pink-50 p-4 rounded-lg text-center"><div class="text-3xl font-bold text-accent">4</div><div class="text-sm text-gray-600">Danh M·ª•c</div></div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between items-end mb-6"><h2 class="text-3xl font-bold text-secondary font-serif">S·∫£n Ph·∫©m M·ªõi</h2><button onclick="app.navigate('shop')" class="text-primary font-bold hover:underline">Xem t·∫•t c·∫£ &rarr;</button></div>
                            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6">${storeData.products.slice(0, 4).map(p => this.createProductCard(p)).join('')}</div>
                        </div>
                    </div>`;
                
                new Chart(document.getElementById('categoryChart').getContext('2d'), {
                    type: 'doughnut',
                    data: { labels: ['Tr·∫ª Em', 'N·ªØ', 'Nam', 'M√πa ƒê√¥ng'], datasets: [{ data: [catCounts.kids, catCounts.adult, catCounts.men, catCounts.winter], backgroundColor: ['#5dade2', '#ff6b6b', '#34495e', '#a0aec0'], borderWidth: 0 }] },
                    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
                });
            },

            renderShop() {
                let filteredProducts = storeData.products;
                if (this.currentFilter === 'new') {
                    filteredProducts = storeData.products.filter(p => p.isNew === true);
                } else if (this.currentFilter !== 'all') {
                    filteredProducts = storeData.products.filter(p => p.category === this.currentFilter);
                }

                let pageTitle = "T·∫•t C·∫£ S·∫£n Ph·∫©m";
                if(this.currentFilter === 'kids') pageTitle = "Th·ªùi Trang Tr·∫ª Em";
                if(this.currentFilter === 'adult') pageTitle = "Th·ªùi Trang N·ªØ";
                if(this.currentFilter === 'men') pageTitle = "Th·ªùi Trang Nam";
                if(this.currentFilter === 'winter') pageTitle = "ƒê·ªì M√πa ƒê√¥ng";
                if(this.currentFilter === 'new') pageTitle = "H√†ng M·ªõi V·ªÅ";

                this.container.innerHTML = `
                    <div class="space-y-8 animate-fade-in">
                        ${this.renderNavBar('shop')}
                        
                        <div class="text-center"><h2 class="text-3xl font-bold text-secondary font-serif mb-2">${pageTitle}</h2></div>
                        
                        <div class="flex flex-col md:flex-row justify-center gap-4">
                            <input type="text" id="searchInput" placeholder="üîç T√¨m ki·∫øm..." class="w-full md:w-80 px-4 py-3 border rounded-full focus:outline-none focus:border-primary shadow-sm" oninput="app.filterProducts()">
                        </div>
                        
                        <div id="shop-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                            ${filteredProducts.length > 0 ? filteredProducts.map(p => this.createProductCard(p)).join('') : '<div class="col-span-full text-center py-10 text-gray-500">Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o.</div>'}
                        </div>
                    </div>`;
            },

            renderCart() {
                const nav = this.renderNavBar('cart');
                if (!storeData.cart.length) {
                    this.container.innerHTML = `
                        ${nav}
                        <div class="flex flex-col items-center justify-center py-20"><div class="text-6xl mb-4">üõí</div><h2 class="text-2xl font-bold text-secondary mb-4">Gi·ªè h√†ng tr·ªëng</h2><button onclick="app.navigate('shop')" class="bg-primary text-white font-bold py-2 px-6 rounded-full shadow">Mua s·∫Øm ngay</button></div>`;
                    return;
                }
                let total = 0;
                const rows = storeData.cart.map(item => {
                    total += item.price * item.qty;
                    return `<tr class="border-b hover:bg-blue-50"><td class="py-4 px-2 flex items-center gap-3"><img src="${item.img}" class="w-12 h-12 rounded object-cover hidden sm:block" onerror="this.src='https://via.placeholder.com/60'"><span class="font-bold text-sm">${item.name}</span></td><td class="py-4 px-2 text-sm">${item.price.toLocaleString('vi-VN')}‚Ç´</td><td class="py-4 px-2 flex items-center gap-1"><button onclick="app.changeQty(${item.id}, -1)" class="w-6 h-6 rounded bg-gray-200 font-bold hover:bg-gray-300">-</button><span class="w-6 text-center text-sm font-bold">${item.qty}</span><button onclick="app.changeQty(${item.id}, 1)" class="w-6 h-6 rounded bg-gray-200 font-bold hover:bg-gray-300">+</button></td><td class="py-4 px-2 font-bold text-accent text-sm">${(item.price*item.qty).toLocaleString('vi-VN')}‚Ç´</td><td class="py-4 px-2"><button onclick="app.removeItem(${item.id})" class="text-red-500 font-bold hover:text-red-700 text-xl">&times;</button></td></tr>`;
                }).join('');
                this.container.innerHTML = `${nav} <div class="max-w-4xl mx-auto"><h2 class="text-2xl font-bold text-secondary mb-6 text-center">Gi·ªè H√†ng</h2><div class="bg-white rounded-xl shadow overflow-hidden"><div class="overflow-x-auto"><table class="w-full text-left"><thead class="bg-blue-50 text-secondary text-xs uppercase"><tr><th class="py-3 px-2">S·∫£n ph·∫©m</th><th class="py-3 px-2">Gi√°</th><th class="py-3 px-2">SL</th><th class="py-3 px-2">T·ªïng</th><th></th></tr></thead><tbody>${rows}</tbody></table></div><div class="p-6 bg-gray-50 flex flex-col sm:flex-row justify-end items-center gap-4"><div class="text-lg">T·ªïng: <span class="font-bold text-accent text-xl">${total.toLocaleString('vi-VN')}‚Ç´</span></div><button onclick="app.navigate('checkout')" class="bg-primary text-white font-bold py-2 px-8 rounded-full shadow w-full sm:w-auto">Thanh To√°n</button></div></div></div>`;
            },

            renderCheckout() {
                this.container.innerHTML = `${this.renderNavBar('')} <div class="max-w-xl mx-auto"><h2 class="text-2xl font-bold text-secondary mb-6 text-center">Th√¥ng Tin Giao H√†ng</h2><form onsubmit="app.processCheckout(event)" class="bg-white p-6 rounded-xl shadow border space-y-4"><div><label class="block font-bold text-sm mb-1">H·ªç t√™n</label><input type="text" required class="w-full border p-2 rounded"></div><div><label class="block font-bold text-sm mb-1">SƒêT</label><input type="tel" required class="w-full border p-2 rounded"></div><div><label class="block font-bold text-sm mb-1">ƒê·ªãa ch·ªâ</label><textarea rows="2" required class="w-full border p-2 rounded"></textarea></div><button type="submit" class="w-full bg-primary text-white font-bold py-3 rounded shadow mt-4">X√°c Nh·∫≠n</button><button type="button" onclick="app.navigate('cart')" class="w-full text-center text-sm text-gray-500 underline mt-2">Quay l·∫°i</button></form></div>`;
            },

            createProductCard(p) {
                return `
                    <div class="bg-white rounded-xl overflow-hidden shadow border flex flex-col h-full group hover:shadow-xl transition duration-300">
                        <div class="relative overflow-hidden cursor-pointer h-64 bg-gray-100" onclick="app.openModal(${p.id})">
                            <img src="${p.img}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" onerror="this.src='https://via.placeholder.com/300x300?text=IMG'">
                        </div>
                        <div class="p-5 flex flex-col flex-grow text-center">
                            <h3 class="text-lg font-bold text-secondary mb-2 line-clamp-2 h-14 overflow-hidden">${p.name}</h3>
                            <div class="text-accent font-bold text-xl mb-4">${p.price.toLocaleString('vi-VN')}‚Ç´</div>
                            <button onclick="app.addToCart(${p.id})" class="mt-auto w-full border-2 border-primary text-primary font-bold py-2 rounded-full hover:bg-primary hover:text-white transition uppercase text-xs tracking-wider">Th√™m v√†o gi·ªè</button>
                        </div>
                    </div>`;
            },

            filterProducts() {
                const search = document.getElementById('searchInput').value.toLowerCase();
                const filtered = storeData.products.filter(p => {
                    const matchSearch = p.name.toLowerCase().includes(search);
                    let matchCat = true;
                    if (this.currentFilter === 'new') matchCat = p.isNew === true;
                    else if (this.currentFilter !== 'all') matchCat = p.category === this.currentFilter;
                    return matchSearch && matchCat;
                });
                document.getElementById('shop-grid').innerHTML = filtered.length ? filtered.map(p => this.createProductCard(p)).join('') : `<div class="col-span-full text-center py-10 text-gray-500">Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m.</div>`;
            },

            openModal(id) {
                const p = storeData.products.find(x => x.id === id);
                if (!p) return;
                document.getElementById('modal-img').src = p.img;
                document.getElementById('modal-title').innerText = p.name;
                document.getElementById('modal-price').innerText = p.price.toLocaleString('vi-VN') + '‚Ç´';
                document.getElementById('modal-desc').innerText = p.desc;
                const thumbs = document.getElementById('modal-thumbnails');
                thumbs.innerHTML = '';
                (p.images || [p.img]).forEach((src, idx) => {
                    const img = document.createElement('img');
                    img.src = src;
                    img.className = `w-16 h-16 object-cover rounded border-2 cursor-pointer thumb-item ${idx === 0 ? 'thumb-selected' : 'border-transparent'}`;
                    img.onclick = function() {
                        document.getElementById('modal-img').src = src;
                        thumbs.querySelectorAll('img').forEach(i => {
                            i.classList.remove('thumb-selected');
                            i.classList.add('border-transparent');
                        });
                        this.classList.add('thumb-selected');
                        this.classList.remove('border-transparent');
                    }
                    thumbs.appendChild(img);
                });
                document.getElementById('modal-add-btn').onclick = () => { this.addToCart(p.id); this.closeModal(); };
                const m = document.getElementById('product-modal'); m.classList.remove('hidden'); setTimeout(() => { m.classList.remove('opacity-0'); m.querySelector('div').classList.replace('scale-95', 'scale-100'); }, 10);
            },
            closeModal() { const m = document.getElementById('product-modal'); m.classList.add('opacity-0'); m.querySelector('div').classList.replace('scale-100', 'scale-95'); setTimeout(() => m.classList.add('hidden'), 300); },

            addToCart(id) {
                const p = storeData.products.find(x => x.id === id);
                const item = storeData.cart.find(x => x.id === id);
                if (item) item.qty++; else storeData.cart.push({ ...p, qty: 1 });
                this.saveCart(); this.updateCartCount();
                this.showToast(`ƒê√£ th√™m "${p.name}" v√†o gi·ªè h√†ng!`);
            },

            changeQty(id, d) {
                const item = storeData.cart.find(x => x.id === id);
                if (item) {
                    item.qty += d;
                    if (item.qty <= 0) {
                        storeData.cart = storeData.cart.filter(x => x.id !== id);
                        this.showToast("ƒê√£ x√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè!", true); 
                    }
                }
                this.saveCart(); this.renderCart(); this.updateCartCount();
            },

            removeItem(id) {
                storeData.cart = storeData.cart.filter(x => x.id !== id);
                this.saveCart(); this.renderCart(); this.updateCartCount();
                this.showToast("ƒê√£ x√≥a s·∫£n ph·∫©m!", true);
            },

            processCheckout(e) { 
                e.preventDefault(); 
                this.showToast("ƒê·∫∑t h√†ng th√†nh c√¥ng!"); 
                storeData.cart = []; 
                this.saveCart(); 
                this.updateCartCount(); 
                setTimeout(() => this.navigate('home'), 1500); 
            },
            
            saveCart() { localStorage.setItem("zuzulan_cart", JSON.stringify(storeData.cart)); },
            updateCartCount() { document.getElementById('cart-count').innerText = storeData.cart.reduce((s, i) => s + i.qty, 0); }
        };

        window.onload = () => app.init();
    </script>
</body>
</html>
